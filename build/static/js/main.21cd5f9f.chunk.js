(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{110:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(11),l=a.n(r),i=a(10),o=a(156),m=a(111),u=a(157),s=a(154),f=a(150),b=a(159),d=a(151),h=a(152),g=a(160),E=a(153),p=a(161),j=a(149),y=a(60),O=a.n(y);function v(){return c.a.createElement(O.a,{type:"ThreeDots",color:"#3f51b5",height:300,width:300,timeout:8e3})}var S=a(26),k=a(142),x=a(145),C=a(146),N=a(113),w=a(155),_=a(163);function T(e){var t=e.album,a=e.callback,r=Object(n.useState)(t.genre[0]),l=Object(i.a)(r,2),o=l[0],m=l[1],u=t.title,s=t.genre,f=t.cover_image,d=t.year,h=u.split(" - ")[0],g=u.split(" - ")[1];return c.a.createElement(k.a,{style:{display:"flex",alignItems:"center",textAlign:"center",margin:".5rem",flexDirection:"column",padding:"1rem"}},c.a.createElement(x.a,{style:{width:300,height:300},image:f}),c.a.createElement(C.a,null,c.a.createElement(N.a,{gutterBottom:!0,variant:"h5",component:"h5"},g," ","-",d),c.a.createElement(N.a,{variant:"body2",component:"p"},h),c.a.createElement(w.a,{variant:"outlined",id:"demo-simple-select-filled",value:o,onChange:function(e){return m(e.target.value)},style:{marginTop:"1rem"}},s.map((function(e){return c.a.createElement(_.a,{value:e,key:Object(b.a)()},e)})))),c.a.createElement(j.a,{size:"medium",color:"primary",onClick:function(){return a(Object(S.a)(Object(S.a)({},t),{},{genre:o}))}},"Add"))}var z=Object(f.a)({form_control:{display:"flex",justifyContent:"center"},form_element:{margin:".5rem"},switch:{display:"flex",justifyContent:"center"}}),A=a(158),D=Object(f.a)((function(e){return{root:{"& > * + *":{marginTop:e.spacing(2)}}}}));function P(e){var t=e.count,a=e.page,n=e.setPage,r=D();return c.a.createElement("div",{className:r.root},c.a.createElement(A.a,{count:t,page:a,onChange:function(e,t){n(t)},size:"small"}))}function B(e){var t=e.notify,a=Object(n.useState)(""),r=Object(i.a)(a,2),l=r[0],o=r[1],m=Object(n.useState)(),u=Object(i.a)(m,2),s=u[0],f=u[1],y=Object(n.useState)(!1),O=Object(i.a)(y,2),S=O[0],k=O[1],x=Object(n.useState)(!1),C=Object(i.a)(x,2),N=C[0],w=C[1],_=Object(n.useState)(!1),A=Object(i.a)(_,2),D=A[0],B=A[1],J=Object(n.useState)(1),I=Object(i.a)(J,2),L=I[0],M=I[1],R=Object(n.useState)(),q=Object(i.a)(R,2),F=q[0],G=q[1],H=z();function W(e){var a=e.id,n=e.genre,c={id:a,title:e.title,genre:n,cover_image:e.cover_image,year:e.year,master_url:e.master_url};fetch("/api/albums",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(c)}).then((function(e){return e.json()})).then((function(e){t(e)})).catch((function(e){t(e.message)}))}function $(e){if(e&&e.preventDefault(),""!==l){var a="/search?page=".concat(L);N&&(a+="&barcode=true"),D&&(a+="&masters=true"),k(!0),f(null),G(null),fetch(a,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({query:l})}).then((function(e){return e.json()})).then((function(e){k(!1),f(e.results),G(e.pagination.pages)}))}else t("Search field can not be empty")}return Object(n.useEffect)((function(){F&&$()}),[L]),c.a.createElement(c.a.Fragment,null,c.a.createElement(d.a,{container:!0,justify:"center"},c.a.createElement("form",{onSubmit:$},c.a.createElement(h.a,null,c.a.createElement(g.a,{className:H.form_element,onChange:function(e){return o(e.target.value)},label:"Search",variant:"outlined"}),c.a.createElement(E.a,{className:H.switch,control:c.a.createElement(p.a,{checked:N,onChange:function(){return w(!N)},name:"barcode",color:"primary"}),label:"Barcode"}),c.a.createElement(E.a,{className:H.switch,control:c.a.createElement(p.a,{checked:D,onChange:function(){return B(!D)},name:"barcode",color:"primary"}),label:"Master"}),c.a.createElement(j.a,{className:H.form_element,onClick:$,variant:"contained",color:"primary"},"Search")))),c.a.createElement(d.a,{container:!0,justify:"space-evenly"},s?s.map((function(e){return c.a.createElement(d.a,{key:Object(b.a)(),item:!0,xs:12,sm:6,md:4},c.a.createElement(T,{album:e,callback:W}))})):"",S&&c.a.createElement(v,null)),c.a.createElement(d.a,{container:!0,justify:"center"},F?c.a.createElement(P,{count:F,page:L,setPage:M}):null))}var J=a(47),I=a(64),L=a.n(I);function M(e){var t=e.data,a=t.maxSize,n=t.records,r=t.name,l=t.genre,i=t.id,o=e.callback;return c.a.createElement(m.a,{style:{padding:"1rem",margin:"1rem",textAlign:"center",position:"relative"}},c.a.createElement(N.a,{variant:"h3"},r),c.a.createElement(N.a,{variant:"body1"},n.length,"/",a),c.a.createElement(N.a,{variant:"body2"},l),c.a.createElement(L.a,{style:{position:"absolute",top:".5rem",right:".5rem",cursor:"pointer"},color:"secondary",fontSize:"large",onClick:function(){return o(i)}}))}function R(e){var t=e.notify,a=Object(n.useState)(),r=Object(i.a)(a,2),l=r[0],o=r[1],m=Object(n.useState)(),u=Object(i.a)(m,2),s=u[0],f=u[1],E=Object(n.useState)([""]),p=Object(i.a)(E,2),y=p[0],O=p[1],v=Object(n.useState)(y[0]),k=Object(i.a)(v,2),x=k[0],C=k[1],T=z();function A(){fetch("/api/folders").then((function(e){return e.json()})).then((function(e){o(e)})).catch((function(e){t(e.message)}))}function D(e){"genre"===e.target.name&&C(e.target.value),f(Object(S.a)(Object(S.a)({},s),{},Object(J.a)({},e.target.name,e.target.value)))}function P(e){fetch("/api/folders/".concat(e),{method:"DELETE"}).then((function(e){return e.json()})).then((function(e){t(e),A()})).catch((function(e){t(e.message)}))}return Object(n.useEffect)((function(){A(),fetch("/api/genres").then((function(e){return e.json()})).then((function(e){O(Object.keys(e)),C(Object.keys(e)[0]),f(Object(S.a)(Object(S.a)({},s),{},{genre:Object.keys(e)[0]}))}))}),[]),c.a.createElement(d.a,{container:!0,justify:"center"},c.a.createElement(d.a,{container:!0,justify:"center"},c.a.createElement(N.a,{variant:"h5",component:"h5"},"Folders")),c.a.createElement(h.a,null,c.a.createElement(d.a,{container:!0,direction:"row",justify:"center"},c.a.createElement(g.a,{className:T.form_element,name:"name",onChange:D,label:"Name",variant:"outlined"}),c.a.createElement(g.a,{className:T.form_element,name:"maxSize",onChange:D,label:"Maximum Size",variant:"outlined"}),c.a.createElement(w.a,{variant:"outlined",className:T.form_element,value:x,onChange:D,name:"genre"},y.map((function(e){return c.a.createElement(_.a,{value:e,key:Object(b.a)()},e)})))),c.a.createElement(d.a,{container:!0,direction:"row",justify:"center"},c.a.createElement(j.a,{className:T.form_element,onClick:function(e){e.preventDefault(),fetch("/api/folders",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(s)}).then((function(e){return e.json()})).then((function(e){t(e),A()})).catch((function(e){t(e.message)}))},variant:"contained",color:"primary"},"Add"),c.a.createElement(j.a,{className:T.form_element,onClick:function(){fetch("/api/albums/sort").then((function(e){return e.json()})).then((function(e){t(e),A()})).catch((function(e){t(e.message)}))},variant:"contained",color:"primary"},"Sort Records"))),c.a.createElement(d.a,{container:!0,justify:"center"},l?l.map((function(e){return c.a.createElement(d.a,{key:Object(b.a)(),item:!0,xs:12,sm:6,md:4},c.a.createElement(M,{data:e,callback:P}))})):""))}var q=a(54),F=a.n(q),G=a(65);function H(e){var t=e.album,a=e.callback,n=t.title,r=t.genre,l=t.cover_image,i=t.year,o=t.folder,m=t.position,u=n.split(" - ")[0],s=n.split(" - ")[1];return c.a.createElement(k.a,{style:{display:"flex",alignItems:"center",textAlign:"center",margin:".5rem",flexDirection:"column",padding:"1rem 1rem 0 "}},c.a.createElement(x.a,{style:{width:300,height:300},image:l}),c.a.createElement(C.a,null,c.a.createElement(N.a,{gutterBottom:!0,variant:"h5",component:"h5"},s," ","-"," ",i),c.a.createElement(N.a,{variant:"body2",color:"textSecondary",component:"p"},u," ","-"," ",r),o?c.a.createElement(N.a,{variant:"h5",component:"h4"},o,"number"===typeof m&&"/".concat(m)):c.a.createElement("p",null,"Not yet sorted"),c.a.createElement(j.a,{size:"medium",color:"primary",onClick:function(){return a(t)}},"Remove")))}var W=a(66),$=a(164);function K(e){var t=e.selected,a=e.setSelected,r=e.genres,l=e.setGenres;function i(e){return t.includes(e)}function o(e){var n=e.target.classList.contains("genre_filter")?e.target.getAttribute("name"):e.target.parentNode.getAttribute("name");i(n)?a(t.filter((function(e){return e!==n}))):a([].concat(Object(W.a)(t),[n]))}return Object(n.useEffect)((function(){fetch("/api/genres").then((function(e){return e.json()})).then((function(e){l(Object.keys(e))}))}),[]),c.a.createElement("div",{className:"filters"},r?r.map((function(e){return i(e)?c.a.createElement($.a,{className:"genre_filter",key:Object(b.a)(),label:e,clickable:!0,onClick:o,name:e}):c.a.createElement($.a,{className:"genre_filter",color:"primary",key:Object(b.a)(),label:e,clickable:!0,onClick:o,name:e})})):null)}function Q(e){var t=e.notify,a=Object(n.useState)(),r=Object(i.a)(a,2),l=r[0],o=r[1],m=Object(n.useState)(),u=Object(i.a)(m,2),s=u[0],f=u[1],E=Object(n.useState)(),p=Object(i.a)(E,2),j=p[0],y=p[1],O=Object(n.useState)([]),S=Object(i.a)(O,2),k=S[0],x=S[1],C=Object(n.useState)(null),w=Object(i.a)(C,2),_=w[0],T=w[1],A=Object(n.useState)(""),D=Object(i.a)(A,2),B=D[0],J=D[1],I=Object(n.useState)(1),L=Object(i.a)(I,2),M=L[0],R=L[1],q=Object(n.useState)(),W=Object(i.a)(q,2),$=W[0],Q=W[1],U=z();function V(e){return X.apply(this,arguments)}function X(){return(X=Object(G.a)(F.a.mark((function e(a){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("/api/albums/".concat(a.id),{method:"DELETE"}).then((function(e){return e.json()})).then((function(e){t(e),f(s.filter((function(e){return e.id!==a.id}))),y(s.slice(10*(M-1),10*(M-1)+10))})).catch((function(e){return t(e.message)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){fetch("/api/albums").then((function(e){return e.json()})).then((function(e){o(e),f(e),y(e.slice(10*(M-1),10*(M-1)+10))})).catch((function(e){t(e.message)}))}),[]),Object(n.useEffect)((function(){!function(){if(l){var e=new RegExp(B,"i"),t=l.filter((function(t){return e.test(t.title)}));k.forEach((function(e){t=t.filter((function(t){return t.genre!==e}))})),f(t),y(t.slice(10*(M-1),10*(M-1)+10))}}()}),[k,B,M]),Object(n.useEffect)((function(){s&&Q(Math.ceil(s.length/10))}),[s]),Object(n.useEffect)((function(){$&&$<M&&R(1)}),[$]),c.a.createElement("main",null,c.a.createElement(d.a,{container:!0,justify:"center"},c.a.createElement(h.a,{className:U.form_control},c.a.createElement(g.a,{className:U.form_element,onChange:function(e){return J(e.target.value)},label:"Search",variant:"outlined"}))),c.a.createElement(d.a,{container:!0,justify:"center"},c.a.createElement(K,{selected:k,setSelected:x,genres:_,setGenres:T})),s?c.a.createElement(d.a,{container:!0,justify:"center"},c.a.createElement(N.a,{component:"h6",variant:"subtitle1"},s.length,s.length>1?" hits":" hit")):null,c.a.createElement(d.a,{container:!0,justify:"space-evenly"},j?j.map((function(e){return c.a.createElement(d.a,{key:Object(b.a)(),item:!0,xs:12,sm:6,md:4},c.a.createElement(H,{album:e,callback:V}))})):c.a.createElement(v,null)),c.a.createElement(d.a,{container:!0,justify:"center"},$&&s&&0!==s.length?c.a.createElement(P,{count:$,page:M,setPage:R}):null))}K.defaultProps={selected:[],genres:null};var U=Object(f.a)({app:{backgroundColor:"whitesmoke",minHeight:"100vh"},notification:{position:"fixed",padding:"1rem",bottom:"1rem",right:"1rem",backgroundColor:"blanchedalmond",borderRadius:".2rem",zIndex:"1"}});function V(e){var t=e.children,a=e.value,n=e.index;return c.a.createElement("div",{role:"tabpanel",hidden:a!==n,id:"simple-tabpanel-".concat(n),"aria-labelledby":"simple-tab-".concat(n)},a===n&&c.a.createElement(o.a,{p:3},t))}var X=function(){var e=Object(n.useState)(0),t=Object(i.a)(e,2),a=t[0],r=t[1],l=Object(n.useState)(""),o=Object(i.a)(l,2),f=o[0],b=o[1],d=U(),h=function(e){b(e),setTimeout((function(){b("")}),3e3)};return c.a.createElement("div",{className:d.app},""!==f?c.a.createElement("div",{className:d.notification},f):"",c.a.createElement("nav",{className:"nav"},c.a.createElement(m.a,{square:!0},c.a.createElement(u.a,{value:a,indicatorColor:"primary",textColor:"primary",onChange:function(e,t){r(t)},centered:!0},c.a.createElement(s.a,{label:"Home"}),c.a.createElement(s.a,{label:"Library"}),c.a.createElement(s.a,{label:"Settings"})))),c.a.createElement("main",null,c.a.createElement(V,{value:a,index:0},c.a.createElement(B,{notify:h})),c.a.createElement(V,{value:a,index:1},c.a.createElement(Q,{notify:h})),c.a.createElement(V,{value:a,index:2},c.a.createElement(R,{notify:h}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(X,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},80:function(e,t,a){e.exports=a(110)}},[[80,1,2]]]);
//# sourceMappingURL=main.21cd5f9f.chunk.js.map